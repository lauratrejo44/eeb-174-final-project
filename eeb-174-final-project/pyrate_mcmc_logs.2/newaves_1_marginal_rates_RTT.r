# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/pyrate_mcmc_logs/newaves_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/pyrate_mcmc_logs/newaves_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(1.64660210197, 1.64660210197,0.159793951864,0.159793951864,0.159793951864,0.159793951864,0.159793951864,0.148437221731,0.157458298969,0.14817436364,0.144042220451,0.14348225387,0.143710368337,0.14348225387,0.14348225387,0.146371346508,0.146371346508,0.14348225387,0.14348225387,0.145491911817,0.145491911817,0.14348225387,0.141231939492,0.133487946954,0.130423134079,0.102554922989,0.0558538285269,0.0451657788923,0.0449677451199,0.0400292790273,0.0287940027154,0.0323059745048,0.0323059745048,0.0287940027154,0.0287940027154,0.0233795550205,0.0323059745048,0.0287940027154,0.0400292790273,0.0400292790273,0.0400292790273,0.0400292790273,0.0400292790273,0.0400292790273,0.0233795550205,0.0233795550205,0.0287940027154,0.075311817098,0.110644230889,0.118965219121,0.118965219121,0.118965219121,0.118965219121,0.110644230889,0.110644230889,0.110644230889,0.118965219121,0.118965219121,0.110644230889,0.110644230889,0.110644230889,0.110644230889,0.110644230889,0.110644230889,0.110644230889,0.110644230889,0.110644230889)
L_hpd_M95=c(2.72726627671, 2.72726627671,0.339644671798,0.339048550801,0.339048550801,0.339048550801,0.339048550801,0.327257405427,0.325238690218,0.307476167857,0.289442921528,0.279622309295,0.27847150843,0.276220577174,0.276220577174,0.27847150843,0.27847150843,0.27847150843,0.284330568595,0.289442921528,0.289442921528,0.299350241487,0.322508900443,0.319118557811,0.321391441119,0.323602455901,0.32226828861,0.317605429066,0.317401026032,0.33960033718,0.38338256571,0.426190509309,0.470202460833,0.49033319176,0.49033319176,0.49033319176,0.529245738775,0.530021516152,0.545341961554,0.546589089606,0.546589089606,0.546589089606,0.546589089606,0.546589089606,0.576400195161,1.83794997993,3.99015544925,5.16120082024,5.22593485648,5.24272824837,5.24272824837,5.24272824837,5.24272824837,5.29797342425,5.29797342425,5.29797342425,5.23926344696,5.16120082024,5.15039615436,5.15039615436,5.15039615436,5.15039615436,5.15039615436,5.15039615436,5.15039615436,5.15039615436,5.15039615436)
M_hpd_m95=c(1.82818047671, 1.82818047671,0.108792525768,0.109707980433,0.109707980433,0.107426985045,0.115213110353,0.102893106112,0.101455668148,0.102893106112,0.0893948131811,0.0826304485102,0.0746584196741,0.0725460504538,0.0725460504538,0.0631224843718,0.0623993301579,0.0629524177694,0.0596432403791,0.0577941211948,0.0559249646338,0.0530541269735,0.0488047395611,0.0464631365845,0.0291526594754,0.0238601275678,0.0174668079086,0.0162878952397,0.0162878952397,0.0174668079086,0.0124278619547,0.0124278619547,0.0124278619547,0.0124278619547,0.0124278619547,0.0124278619547,0.0136242438799,0.0136242438799,0.0136242438799,0.0136242438799,0.0136242438799,0.0136242438799,0.0136242438799,0.0136242438799,0.0136242438799,0.0104181766191,0.00833917075266,0.00833917075266,0.00833917075266,0.00833917075266,0.00833917075266,0.0104181766191,0.305498739523,0.305498739523,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957,0.188644077957)
M_hpd_M95=c(2.85791339688, 2.85791339688,0.278347291373,0.278523973871,0.276420866997,0.273403124445,0.278523973871,0.26463060141,0.26463060141,0.273403124445,0.255724482422,0.240767809388,0.223795473076,0.21574670339,0.21574670339,0.207034764234,0.214059499422,0.215164545725,0.21574670339,0.21574670339,0.215299937829,0.21574670339,0.21574670339,0.21574670339,0.204510845729,0.194279888908,0.197523068879,0.198724689926,0.198724689926,0.197523068879,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.204510845729,0.230065601575,2.56736430417,4.2667581181,4.94469500601,5.11470330991,5.11470330991,5.12308764437,5.33063188193,5.33063188193,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867,5.15862361867)
R_hpd_m95=c(-0.929283191161, -0.929283191161,-0.0352721695844,-0.0440786258149,-0.0440786258149,-0.0352721695844,-0.0452359184313,-0.0352721695844,-0.040574720186,-0.0616311917043,-0.0628026512916,-0.0520306083208,-0.0200860534623,-0.00805396011976,-0.00478913782612,-0.00478913782612,-0.00472410310306,-0.00472410310306,-0.00472410310306,-0.00805396011976,-0.0133167335297,-0.0201503342471,-0.0335133336195,-0.0335133336195,-0.0331715056374,-0.0335133336195,-0.090643966285,-0.0842589810548,-0.0895715250603,-0.104856897359,-0.116286708137,-0.111422251733,-0.113734160303,-0.113734160303,-0.113734160303,-0.116286708137,-0.111422251733,-0.111422251733,-0.113734160303,-0.116286708137,-0.116286708137,-0.116286708137,-0.116286708137,-0.116286708137,-0.113734160303,-0.342537646603,-1.94428729066,-3.69808035156,-4.26717705754,-3.78661611985,-3.78661611985,-3.79188400045,-3.79188400045,-3.79188400045,-3.79188400045,-3.79188400045,-3.92303802834,-3.79188400045,-3.60490741664,-3.60490741664,-3.60490741664,-3.60490741664,-3.60490741664,-3.60490741664,-3.60490741664,-3.60490741664,-3.60490741664)
R_hpd_M95=c(0.52690329794, 0.52690329794,0.175375877775,0.166193599863,0.166193599863,0.172284924285,0.160692346405,0.172284924285,0.175375877775,0.160692346405,0.158142393482,0.154340019915,0.158142393482,0.158142393482,0.158142393482,0.158142393482,0.156253005409,0.160692346405,0.184358069946,0.184358069946,0.184358069946,0.198317061732,0.211503616446,0.217998574566,0.221670698715,0.2492690054,0.242241294876,0.254825422428,0.250201173521,0.265481819719,0.32038741502,0.362449401337,0.405419759319,0.438348141571,0.438348141571,0.438348141571,0.466478652617,0.468331840657,0.468331840657,0.468331840657,0.468331840657,0.468331840657,0.468331840657,0.468331840657,0.539567589618,1.52975793592,5.15488567799,4.53972463101,3.76517520402,3.58439778524,3.48245953638,3.41556123542,3.41556123542,3.31334928769,3.31334928769,3.31334928769,3.05089288766,3.19685258807,3.42154973938,3.42154973938,3.42154973938,3.42154973938,3.42154973938,3.42154973938,3.42154973938,3.42154973938,3.42154973938)
L_mean=c(2.15650277447, 2.15650277447,0.240760094611,0.240610294732,0.240301358261,0.240301358261,0.240181393491,0.239499288247,0.237463558544,0.229904267625,0.219684368967,0.214398801787,0.21406754042,0.213189923546,0.213189923546,0.21303725088,0.21303725088,0.213774531015,0.215816742836,0.216563429784,0.216580883341,0.216338888968,0.217181427914,0.217635218991,0.216410224553,0.210526713943,0.202129393627,0.193294557961,0.192270070828,0.196190065892,0.201609352386,0.206417648848,0.217418587199,0.223566747257,0.223810502668,0.224920043647,0.229537827224,0.230549059751,0.232197901593,0.233029754825,0.233563986254,0.233563986254,0.233563986254,0.233563986254,0.257091366901,0.429949271323,1.0040286163,1.76718625093,2.01690393643,2.02552372477,2.02552372477,2.02552372477,2.02772722499,2.0651996065,2.06879196836,2.07200842529,2.07328066196,1.98549409029,1.97434059062,1.97434059062,1.97434059062,1.97434059062,1.97434059062,1.97434059062,1.97434059062,1.97434059062,1.97434059062)
M_mean=c(2.33804684802, 2.33804684802,0.184104581875,0.184619757732,0.185101085956,0.184458552376,0.183962134064,0.183072033979,0.181862904739,0.179384119024,0.170783762412,0.162034801198,0.15101173508,0.145454026467,0.144376936376,0.143662115812,0.139226220741,0.138642606622,0.136967049975,0.136236739962,0.132425311879,0.132340243283,0.130751553371,0.128912271653,0.119934444253,0.110810542451,0.105421507456,0.105102051908,0.105080975602,0.103539741649,0.104729408697,0.104729408697,0.104729408697,0.104473628062,0.104473628062,0.104473628062,0.104449950149,0.104449950149,0.104449950149,0.104449950149,0.104449950149,0.104449950149,0.104449950149,0.104449950149,0.104449950149,0.14111440039,0.412111371141,1.35541317401,1.99296474401,2.19853540664,2.22555059255,2.33701448322,2.38706669402,2.38706669402,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321,2.3878317321)
R_mean=c(-0.18154407355, -0.18154407355,0.0566555127359,0.0559905370001,0.0552002723055,0.055842805885,0.056219259427,0.0564272542677,0.0556006538048,0.0505201486013,0.048900606555,0.052364000589,0.0630558053405,0.0677358970791,0.0688129871697,0.0693751350678,0.0738110301396,0.0751319243933,0.0788496928612,0.0803266898223,0.0841555714615,0.0839986456845,0.0864298745427,0.088722947338,0.0964757803001,0.0997161714921,0.0967078861703,0.0881925060529,0.0871890952262,0.0926503242439,0.0968799436884,0.101688240151,0.112689178502,0.119093119195,0.119336874606,0.120446415585,0.125087877075,0.126099109602,0.127747951445,0.128579804676,0.129114036105,0.129114036105,0.129114036105,0.129114036105,0.152641416753,0.288834870933,0.59191724516,0.411773076926,0.0239391924241,-0.173011681875,-0.200026867778,-0.311490758453,-0.359339469033,-0.321867087516,-0.319039763741,-0.315823306808,-0.314551070142,-0.402337641811,-0.413491141474,-0.413491141474,-0.413491141474,-0.413491141474,-0.413491141474,-0.413491141474,-0.413491141474,-0.413491141474,-0.413491141474)
trans=0.5
age=(0:(67-1))* -1
plot(age,age,type = 'n', ylim = c(0, 5.82777076668), xlim = c(-70.35,3.35), ylab = 'Speciation rate', xlab = 'Ma',main='newaves' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 5.86369507013), xlim = c(-70.35,3.35), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-4.69389476329, 5.67037424579), xlim = c(-70.35,3.35), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-70.35,3.35), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()